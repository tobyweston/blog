<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Astro v5.17.3"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><!-- Canonical URL --><link rel="canonical" href="https://baddotrobot.com/blog/2022-12-07-luhn-algorithm/"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="bad.robot" href="/rss.xml"><!-- Primary Meta Tags --><title>Luhn Algorithm</title><meta name="title" content="Luhn Algorithm"><meta name="description" content="Compare an imperative and functional implementation of the Luhn Algorithm. See how functional programming emphasises transformations and immutability over state mutation."><meta name="keywords" content="Luhn algorithm, functional programming, Scala, Java, imperative vs declarative, pure functions, immutability"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://baddotrobot.com/blog/2022-12-07-luhn-algorithm/"><meta property="og:title" content="Luhn Algorithm"><meta property="og:description" content="Compare an imperative and functional implementation of the Luhn Algorithm. See how functional programming emphasises transformations and immutability over state mutation."><meta property="og:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><meta property="og:site_name" content="bad.robot"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://baddotrobot.com/blog/2022-12-07-luhn-algorithm/"><meta property="twitter:title" content="Luhn Algorithm"><meta property="twitter:description" content="Compare an imperative and functional implementation of the Luhn Algorithm. See how functional programming emphasises transformations and immutability over state mutation."><meta property="twitter:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Luhn Algorithm","description":"Compare an imperative and functional implementation of the Luhn Algorithm. See how functional programming emphasises transformations and immutability over state mutation.","datePublished":"2022-12-07T00:00:00.000Z","image":"https://baddotrobot.com/images/heroes/algorithm.jpg","url":"https://baddotrobot.com/blog/2022-12-07-luhn-algorithm/","author":{"@type":"Person","name":"Toby Weston","url":"https://baddotrobot.com"},"publisher":{"@type":"Person","name":"bad.robot"}}</script><link rel="stylesheet" href="/_astro/index.CzF6U4o9.css">
<link rel="stylesheet" href="/_astro/_slug_.DbZHOt6G.css"><style>.youtube-embed[data-astro-cid-krwaudza]{position:relative;width:100%;padding-top:56.25%;background:#0f172a;border-radius:.5rem;overflow:hidden;margin-bottom:2rem}iframe[data-astro-cid-krwaudza]{position:absolute;top:0;left:0;width:100%;height:100%;border:none}
</style></head> <body class="bg-white text-gray-900"> <header class="header" data-astro-cid-3ef6ksr2> <div class="header-container" data-astro-cid-3ef6ksr2> <div class="logo-section" data-astro-cid-3ef6ksr2> <a href="/" class="logo-link" data-astro-cid-3ef6ksr2> <img src="/_astro/robot-logo_105x132.N1ZQY9mA_Zj02tT.webp" alt="bad.robot logo" data-astro-cid-3ef6ksr2="true" loading="lazy" decoding="async" fetchpriority="auto" width="84" height="106" class="logo-image"> <div class="logo-text-block" data-astro-cid-3ef6ksr2> <h1 class="logo-title logo-text header-logo-text" data-astro-cid-3ef6ksr2>bad.robot</h1> <h2 class="logo-subtitle logo-subtitle-text header-subtitle" data-astro-cid-3ef6ksr2>good robots do what they&#39;re told</h2> </div> </a> </div> <nav class="nav" data-astro-cid-3ef6ksr2> <a href="/blog" data-astro-cid-3ef6ksr2>Blog</a> <a href="/book" data-astro-cid-3ef6ksr2>Books</a> <a href="/video" data-astro-cid-3ef6ksr2>Videos</a> <a href="/archive" data-astro-cid-3ef6ksr2>Archive</a> </nav> </div> </header>  <main id="site-main" class="mx-auto w-full max-w-6xl px-4 pt-4">   <div class="py-12"> <article class=""> <!--{heroImage && (--> <!--  <div class="hero-image mb-8">--> <!--    <img src={heroImage} alt={title} class="w-full h-auto rounded-lg shadow-lg" />--> <!--  </div>--> <!--)}--> <div class="article-title-section mb-8"> <p class="detail-kicker">Blog</p> <h1 class="article-title-section h1">Luhn Algorithm</h1>  <p class="article-description">Compare an imperative and functional implementation of the Luhn Algorithm. See how functional programming emphasises transformations and immutability over state mutation.</p> </div> <div class="article-meta"> <div class="article-date"> <strong>Published:</strong> <time datetime="2022-12-07T00:00:00.000Z"> Dec 7, 2022 </time> </div>  </div> <div class="prose">  <p>In this post, I wanted to compare a typical imperative implementation of the Luhn Algorithm with a more Functional (as in Functional Programming) approach.</p>
<p>Check out the video below before we discuss in a little more detail.</p>
<div class="youtube-embed" data-astro-cid-krwaudza> <iframe src="https://www.youtube-nocookie.com/embed/TpUlJhuEiP8?rel=0" title="Luhn Algorithm - Imperative vs Functional" loading="lazy" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen data-astro-cid-krwaudza></iframe> </div> 
<h1 id="imperative-java">Imperative Java</h1>
<p>The imperative implementation is fairly typical. We call it imperative because its a very prescriptive set of statements which run in sequence from top to bottom. The statements or commands alter the state of the program and in our case, give a result. The program very much describes <em>how</em> to get that result.</p>
<p>Imperative is often used in contrast to declarative programming. In declarative programming, the program focuses less on how to achieve some result and more on <em>what</em> the program should accomplish. The details of the <em>how</em> are left to the runtime or interpreter (the thing that’s going to execute the program).</p>
<p>I would also add that there is no real attempt at abstraction or object-oriented modelling in this solution. For me, that means there’s been no attempt to help the reader understand what the program is trying to achieve only how it goes about it. We should expect it to be hard to work with going forward. You can also see that this will be tricky to test, specifically to test in small bite size pieces. Usually, moving towards better abstractions and OO naturally leads to easier to read, reason and test code. There’s a related but subtle build on this when we think about test <em>driving</em> code. When you write tests first and implementation second, you make the priority to be able to write easy to test code. As a side effect, you often get good abstraction and good design.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#F97583">public</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> Validator</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    public</span><span style="color:#F97583"> boolean</span><span style="color:#B392F0"> validate</span><span style="color:#E1E4E8">(String </span><span style="color:#FFAB70">number</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        int</span><span style="color:#E1E4E8"> sum </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">        boolean</span><span style="color:#E1E4E8"> isSecond </span><span style="color:#F97583">=</span><span style="color:#79B8FF"> false</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> (</span><span style="color:#F97583">int</span><span style="color:#E1E4E8"> index </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> number.</span><span style="color:#B392F0">length</span><span style="color:#E1E4E8">() </span><span style="color:#F97583">-</span><span style="color:#79B8FF"> 1</span><span style="color:#E1E4E8">; index </span><span style="color:#F97583">&gt;=</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">; index</span><span style="color:#F97583">--</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">            // get current string digit, converting to an int</span></span>
<span class="line"><span style="color:#F97583">            int</span><span style="color:#E1E4E8"> digit </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> number.</span><span style="color:#B392F0">charAt</span><span style="color:#E1E4E8">(index) </span><span style="color:#F97583">-</span><span style="color:#9ECBFF"> &#39;0&#39;</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> (isSecond)</span></span>
<span class="line"><span style="color:#E1E4E8">                digit </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> digit </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D">            // Add two digits to handle products &gt; 9</span></span>
<span class="line"><span style="color:#E1E4E8">            sum </span><span style="color:#F97583">+=</span><span style="color:#E1E4E8"> digit </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 10</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">            sum </span><span style="color:#F97583">+=</span><span style="color:#E1E4E8"> digit </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 10</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">            isSecond </span><span style="color:#F97583">=</span><span style="color:#F97583"> !</span><span style="color:#E1E4E8">isSecond;</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#E1E4E8"> (sum </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 10</span><span style="color:#F97583"> ==</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h1 id="functional-scala">Functional Scala</h1>
<p>In the Scala version, we’ve moved away from an imperative style to an approach where we describe the algorithm as a sequence of steps, or in our case <em>transformations</em>. It’s less imperative because the implementation of these “steps” is opaque to the developer. We’re simply combining <em>functions</em> like <code>map</code> and <code>flatMap</code> and allowing the implementation to figure out how to implement that (don’t worry about the names, that’s not important). The classic example is that the same function call can be used but one implementation may process sequentially whilst another processes concurrently. The developer isn’t prescribing either but is thinking at a higher level and focused on the <em>what</em> not the <em>how</em>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">object</span><span style="color:#B392F0"> Example</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> App</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> validate</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">number</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">String</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Boolean</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">        val</span><span style="color:#FFAB70"> sum</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> number</span></span>
<span class="line"><span style="color:#E1E4E8">            .map(_.asDigit)</span></span>
<span class="line"><span style="color:#E1E4E8">            .reverse</span></span>
<span class="line"><span style="color:#E1E4E8">            .zipWithIndex</span></span>
<span class="line"><span style="color:#E1E4E8">            .map { </span><span style="color:#F97583">case</span><span style="color:#E1E4E8"> (digit, index) </span><span style="color:#F97583">=&gt;</span></span>
<span class="line"><span style="color:#F97583">                if</span><span style="color:#E1E4E8"> (index </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 2</span><span style="color:#F97583"> ==</span><span style="color:#79B8FF"> 0</span><span style="color:#E1E4E8">) digit </span><span style="color:#F97583">else</span><span style="color:#E1E4E8"> digit </span><span style="color:#F97583">*</span><span style="color:#79B8FF"> 2</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">            .flatMap(number </span><span style="color:#F97583">=&gt;</span><span style="color:#B392F0"> List</span><span style="color:#E1E4E8">(number </span><span style="color:#F97583">/</span><span style="color:#79B8FF"> 10</span><span style="color:#E1E4E8">, number </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 10</span><span style="color:#E1E4E8">))</span></span>
<span class="line"><span style="color:#E1E4E8">            .sum</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">        sum </span><span style="color:#F97583">%</span><span style="color:#79B8FF"> 10</span><span style="color:#F97583"> ==</span><span style="color:#79B8FF"> 0</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>In and unto itself though, a move towards a declarative approach doesn’t always mean a move towards a “functional approach”. Using something like Spring annotations is another form of declarative programming but not functional programming. To claim that the Scala implementation is in the functional style, we have to look at another set of characteristics.</p>
<p>Programming languages have to support a rich set of (fairly formal) features to be able to called a functional programming language. Scala is in fact a hybrid functional and object-oriented language. It can do both and it can do both fairly well. More purist functional programming languages like Haskell don’t have the ability to (natively) model objects and object interactions and force you to adhere to the formalisms of functional programming. Java has attempted to retro fit functional programming features but they’re done at the library level and it ultimately falls short as a serious functional programming choice.</p>
<h1 id="what-is-functional-programming">What is Functional Programming?</h1>
<p>So what are these formalisms and which are we demonstrating in the Scala implementation above? Typically, a functional language should support:</p>
<ul>
<li>Higher order and first class functions (typically with anonymous functions, aka lambdas)</li>
<li>“Pure” functions</li>
<li>Referential transparency</li>
<li>Recursion</li>
<li>Lazy evaluations</li>
<li>An emphasis on transformation and immutable data structures to support the above</li>
<li>An emphasis on stateless programs (see transformation above)</li>
<li>A rich type system supporting identifying incomplete or invalid programs based purely on their types</li>
</ul>
<p>In general however, its a bit unfair to define a language as “functional” or otherwise. It’s more about a style of programming than the language itself. You can write programs in JavaScript in a functional style without trying to claim JavaScript is an “FP language”. Some languages do a better job than others and some have been built explicitly as an FP language whilst others just so happen to support some of the above. A good example is recursion. I don’t know any higher order languages that don’t support recursion but something like Scala does a very good of making recursion intuitive and a natural tool to lean on when processing data structures.</p>
<p>In the Scala example above, we have a series of chained functions. Each <em>transforming</em> the data output from the last. The program doesn’t retain any state and doesn’t mutate data (unlike the Java version). This is because each of the transformation functions (like reverse) creates a new data structure (a copy of the input collection modified as appropriate), the original data isn’t modified. The functions are also “pure” as they don’t introduce any side effects. It’s interesting here that Scala encourages this by treating everything as expressions, there are no inherent <em>statements</em> (the difference being that an expression must return a value where as a statement does not need to).</p>
<p>As a final note, Java can also do a lot of these things. It might be an interesting exercise for the reader to write a new Java Luhn implementation in the functional style. For some inspiration, see this example (from earlier). If you want to see a more test driven, expanded Scala solution, have a look at this example.</p>
<h1 id="find-out-more">Find out More</h1>
<p>If you’re interested in learning Scala or more about the “functional style” (which is just as applicable in Java by the way), I’d encourage you to check out my <a href="http://app.pluralsight.com/library/courses/scala-collections/table-of-contents?utm_source=youtube&utm_medium=video&utm_campaign=authordemo">course on Pluralsight</a>. Although it’s focus is on collection types, it’s really more of an introduction to Scala and FP using collections as the exemplars.</p>  </div> </article> </div>  </main> <footer class="py-8 border-t border-gray-200 mt-12"> <div class="container mx-auto px-4 text-center"> <p class="text-xs text-gray-600">&copy; 2008-2026 Toby Weston. All rights reserved. (see some old <a class="text-gray-600 hover:text-sky-600" href="/code/">code</a>)</p> </div> </footer> </body></html>