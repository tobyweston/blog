<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Astro v5.17.3"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><!-- Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-1PVLDLDJQN"></script><script>(function(){const gaId = "G-1PVLDLDJQN";

      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', gaId);
    })();</script><!-- Canonical URL --><link rel="canonical" href="https://baddotrobot.com/blog/2016-01-06-disable-led-for-edimax/"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="bad.robot" href="/rss.xml"><!-- Primary Meta Tags --><title>Disable Edimax Wifi Dongles LED</title><meta name="title" content="Disable Edimax Wifi Dongles LED"><meta name="description" content="Disable the LED on the Edimax EW-7811UN Wi-Fi dongle on Raspberry Pi by recompiling the kernel module. Includes a pre-built binary if you'd rather not compile."><meta name="keywords" content="Edimax EW-7811UN, Raspberry Pi, LED disable, kernel module, 8192cu, Wi-Fi dongle, Raspbian"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://baddotrobot.com/blog/2016-01-06-disable-led-for-edimax/"><meta property="og:title" content="Disable Edimax Wifi Dongles LED"><meta property="og:description" content="Disable the LED on the Edimax EW-7811UN Wi-Fi dongle on Raspberry Pi by recompiling the kernel module. Includes a pre-built binary if you'd rather not compile."><meta property="og:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><meta property="og:site_name" content="bad.robot"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://baddotrobot.com/blog/2016-01-06-disable-led-for-edimax/"><meta property="twitter:title" content="Disable Edimax Wifi Dongles LED"><meta property="twitter:description" content="Disable the LED on the Edimax EW-7811UN Wi-Fi dongle on Raspberry Pi by recompiling the kernel module. Includes a pre-built binary if you'd rather not compile."><meta property="twitter:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Disable Edimax Wifi Dongles LED","description":"Disable the LED on the Edimax EW-7811UN Wi-Fi dongle on Raspberry Pi by recompiling the kernel module. Includes a pre-built binary if you'd rather not compile.","datePublished":"2016-01-06T00:00:00.000Z","image":"https://baddotrobot.com/images/heroes/raspberry-pi.jpg","url":"https://baddotrobot.com/blog/2016-01-06-disable-led-for-edimax/","author":{"@type":"Person","name":"Toby Weston","url":"https://baddotrobot.com"},"publisher":{"@type":"Person","name":"bad.robot"}}</script><link rel="stylesheet" href="/_astro/index.CzF6U4o9.css">
<link rel="stylesheet" href="/_astro/_slug_.DbZHOt6G.css"></head> <body class="bg-white text-gray-900"> <header class="header" data-astro-cid-3ef6ksr2> <div class="header-container" data-astro-cid-3ef6ksr2> <div class="logo-section" data-astro-cid-3ef6ksr2> <a href="/" class="logo-link" data-astro-cid-3ef6ksr2> <img src="/_astro/robot-logo_105x132.N1ZQY9mA_Zj02tT.webp" alt="bad.robot logo" data-astro-cid-3ef6ksr2="true" loading="lazy" decoding="async" fetchpriority="auto" width="84" height="106" class="logo-image"> <div class="logo-text-block" data-astro-cid-3ef6ksr2> <h1 class="logo-title logo-text header-logo-text" data-astro-cid-3ef6ksr2>bad.robot</h1> <h2 class="logo-subtitle logo-subtitle-text header-subtitle" data-astro-cid-3ef6ksr2>good robots do what they&#39;re told</h2> </div> </a> </div> <nav class="nav" data-astro-cid-3ef6ksr2> <a href="/blog" data-astro-cid-3ef6ksr2>Blog</a> <a href="/book" data-astro-cid-3ef6ksr2>Books</a> <a href="/video" data-astro-cid-3ef6ksr2>Videos</a> <a href="/archive" data-astro-cid-3ef6ksr2>Archive</a> </nav> </div> </header>  <main id="site-main" class="mx-auto w-full max-w-6xl px-4 pt-4">   <div class="py-12"> <article class=""> <!--{heroImage && (--> <!--  <div class="hero-image mb-8">--> <!--    <img src={heroImage} alt={title} class="w-full h-auto rounded-lg shadow-lg" />--> <!--  </div>--> <!--)}--> <div class="article-title-section mb-8"> <p class="detail-kicker">Blog</p> <h1 class="article-title-section h1">Disable Edimax Wifi Dongles LED</h1>  <p class="article-description">Disable the LED on the Edimax EW-7811UN Wi-Fi dongle on Raspberry Pi by recompiling the kernel module. Includes a pre-built binary if you&#39;d rather not compile.</p> </div> <div class="article-meta"> <div class="article-date"> <strong>Published:</strong> <time datetime="2016-01-06T00:00:00.000Z"> Jan 6, 2016 </time> </div>  </div> <div class="prose">  <p>Pi specific instructions to disable the LED on the Edimax EW-7811UN USB wireless adapter.</p>
<p>The only way I found to disable the LED is by modifying the <a href="https://en.wikibooks.org/wiki/The_Linux_Kernel/Modules">kernel module</a>. Compiling that meant recompiling the associated kernel to get all the dependencies lined up.</p>
<p>If you don”t want to have a go at compiling the kernel, you can always download the output of my efforts <a href="http://robotooling.com/maven/bad/robot/temperature-machine/">here</a> (built against 4.9.17-v7+).</p>
<h2 id="gather-information">Gather Information</h2>
<p>You’ll need to know the specific kernel version. Run the following.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> uname</span><span style="color:#79B8FF"> -a</span></span></code></pre>
<p>It’ll show something like this</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">Linux</span><span style="color:#9ECBFF"> raspberrypi</span><span style="color:#9ECBFF"> 4.1.13+</span><span style="color:#6A737D"> #826 PREEMPT Fri Nov 13 20:13:22 GMT 2015 armv6l GNU/Linux</span></span></code></pre>
<p>The Edimax uses the <code>8192cu</code> module. You can check it’s loaded with <code>lsmod</code>. You’ll see something like this.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> lsmod</span></span>
<span class="line"><span style="color:#B392F0">Module</span><span style="color:#9ECBFF">                  Size</span><span style="color:#9ECBFF">  Used</span><span style="color:#9ECBFF"> by</span></span>
<span class="line"><span style="color:#B392F0">cfg80211</span><span style="color:#79B8FF">              499834</span><span style="color:#79B8FF">  0</span></span>
<span class="line"><span style="color:#B392F0">rfkill</span><span style="color:#79B8FF">                 22491</span><span style="color:#79B8FF">  2</span><span style="color:#9ECBFF"> cfg80211</span></span>
<span class="line"><span style="color:#B392F0">8192cu</span><span style="color:#79B8FF">                569532</span><span style="color:#79B8FF">  0</span></span>
<span class="line"><span style="color:#79B8FF">...</span></span></code></pre>
<p>For interest, you can get more information running <code>modinfo 8192cu</code>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">filename:</span><span style="color:#9ECBFF">       /lib/modules/4.1.13+/kernel/drivers/net/wireless/rtl8192cu/8192cu.ko</span></span>
<span class="line"><span style="color:#B392F0">version:</span><span style="color:#9ECBFF">        v4.0.2_9000.20130911</span></span>
<span class="line"><span style="color:#B392F0">author:</span><span style="color:#9ECBFF">         Realtek</span><span style="color:#9ECBFF"> Semiconductor</span><span style="color:#9ECBFF"> Corp.</span></span>
<span class="line"><span style="color:#B392F0">description:</span><span style="color:#9ECBFF">    Realtek</span><span style="color:#9ECBFF"> Wireless</span><span style="color:#9ECBFF"> Lan</span><span style="color:#9ECBFF"> Driver</span></span>
<span class="line"><span style="color:#B392F0">license:</span><span style="color:#9ECBFF">        GPL</span></span>
<span class="line"><span style="color:#B392F0">srcversion:</span><span style="color:#9ECBFF">     133EACDEB0C6BEBC3ECA8D0</span></span>
<span class="line"><span style="color:#B392F0">vermagic:</span><span style="color:#9ECBFF">       4.1.13+</span><span style="color:#9ECBFF"> preempt</span><span style="color:#9ECBFF"> mod_unload</span><span style="color:#9ECBFF"> modversions</span><span style="color:#9ECBFF"> ARMv6</span></span>
<span class="line"><span style="color:#79B8FF">...</span></span></code></pre>
<h2 id="get-the-source">Get the Source</h2>
<p>You need both the <strong>module</strong> and <strong>kernel</strong> source.</p>
<p>The latest driver version (<code>v4.0.2_9000</code>) on the <a href="http://218.210.127.131/downloads/downloadsView.aspx?Langid=1&#x26;PNid=21&#x26;PFid=48&#x26;Level=5&#x26;Conn=4&#x26;DownTypeID=3&#x26;GetDown=false&#x26;Downloads=true#2772">Realtek site</a> isn’t actually the latest version. At least, it’s been modified for the Pi. The good news is that the modified version is bundled with the Pi kernel source at <a href="https://github.com/raspberrypi/linux.git">https://github.com/raspberrypi/linux.git</a>. On the Pi, run the following (matching your running kernel version with the <code>--branch</code> option).</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> git</span><span style="color:#9ECBFF"> clone</span><span style="color:#79B8FF"> --branch=rpi-4.1.y</span><span style="color:#79B8FF"> --depth=50</span><span style="color:#9ECBFF"> https://github.com/raspberrypi/linux.git</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> ln</span><span style="color:#79B8FF"> -s</span><span style="color:#9ECBFF"> linux</span><span style="color:#9ECBFF"> linux-</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">uname</span><span style="color:#79B8FF"> -r</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p>The <code>git clone</code> command will download the full source (including headers and all built-in drivers) into a new folder called <code>linux</code>. The symbolic link is just a handy reminder of what you’ve cloned.</p>
<p>The latest source may not match your running kernel version (<code>uname -r</code>). You can check in the <code>Makefile</code>;</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">VERSION</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 4</span></span>
<span class="line"><span style="color:#B392F0">PATCHLEVEL</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 1</span></span>
<span class="line"><span style="color:#B392F0">SUBLEVEL</span><span style="color:#9ECBFF"> =</span><span style="color:#79B8FF"> 15</span></span>
<span class="line"><span style="color:#79B8FF">...</span></span></code></pre>
<p>This is version <code>4.1.15</code> whereas my version was <code>4.1.13</code>. Major versions are stored as branches in the repository (hence the <code>--branch=rpi-4.1.y</code> option above) but if like me, your version is a minor level, you have to scan the commits from the appropriate branch. For example, <a href="https://github.com/raspberrypi/linux/commit/1f2ce4a2e7aea3a2123b17aff62a80553df31e21">4.1.13</a> and <a href="https://github.com/raspberrypi/linux/commit/10f9e3bce7f3ab7ab4d09a9b78c7208c9a1455f7">4.1.12</a> were documented by <a href="https://github.com/gregkh">Greg Kroah-Hartman</a> in the commit messages. You could also try something <code>git log --oneline | grep "Linux 4.1.18"</code> to save manually scanning the logs.</p>
<p>The upshot is that you may need to roll back to the revision that is specifically for your kernel version. That’s why I used <code>--depth=50</code> in the hope of catching the revision I’m interested in.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> linux</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> git</span><span style="color:#9ECBFF"> checkout</span><span style="color:#9ECBFF"> 1f2ce4a2</span><span style="color:#6A737D">     # the SHA of your specific version, this is 4.1.13</span></span></code></pre>
<h2 id="manually-install-the-headers">Manually Install the Headers</h2>
<p>Compiling anything in Linux usually requires you have the kernel header files available. The usual way to get these is to run <code>apt-get install linux-headers-$(uname -r)</code> but the maintainers for the Raspberry Pi linux distribution don’t make them available like this. Instead, we have to rely on the full kernel source you’ve just downloaded.</p>
<p>Create a symbolic link to fill in for the missing <code>build</code> folder in <code>/lib/modules</code> before you try and compile the driver:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> ..</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> ln</span><span style="color:#79B8FF"> -s</span><span style="color:#9ECBFF"> linux</span><span style="color:#9ECBFF"> /lib/modules/</span><span style="color:#E1E4E8">$(</span><span style="color:#B392F0">uname</span><span style="color:#79B8FF"> -r</span><span style="color:#E1E4E8">)</span><span style="color:#9ECBFF">/build</span></span></code></pre>
<p>This creates the missing folder but points at the newly downloaded source. It’s what fixes the infamous error;</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">make[1]:</span><span style="color:#79B8FF"> ***</span><span style="color:#9ECBFF"> /lib/modules/4.1.13+/build:</span><span style="color:#9ECBFF"> No</span><span style="color:#9ECBFF"> such</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> or</span><span style="color:#9ECBFF"> directory</span></span></code></pre>
<h2 id="setup-your-config">Setup your Config</h2>
<p>Before we build the kernel, we need to create a <code>.config</code> file containing the current kernel configuration. The current config should be in the <code>/proc/config.gz</code> file on the Pi. If the file doesn’t exist, run <code>sudo modprobe configs</code> and check again.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> linux</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> zcat</span><span style="color:#9ECBFF"> /proc/config.gz</span><span style="color:#F97583"> ></span><span style="color:#9ECBFF"> .config</span></span></code></pre>
<h2 id="compile-the-kernel">Compile the Kernel</h2>
<p>This isn’t as scary as it sounds. We need to compile the kernel source. We’re not going to install it, but we do want to create various dependencies that are needed to compile the driver. For example, compiling the driver would fail with missing files like   <code>include/generated/autoconf.h</code> or <code>include/config/auto.conf</code>. Compiling the entire kernel is probably a bit overkill but I’ve found it easier than chasing down individual errors.</p>
<p>Before compiling the kernel, get some extra dependencies</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> sudo</span><span style="color:#9ECBFF"> apt-get</span><span style="color:#9ECBFF"> install</span><span style="color:#9ECBFF"> build-essential</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> sudo</span><span style="color:#9ECBFF"> apt-get</span><span style="color:#9ECBFF"> install</span><span style="color:#9ECBFF"> libncurses5-dev</span><span style="color:#6A737D">      # required for menuconfig</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> sudo</span><span style="color:#9ECBFF"> apt-get</span><span style="color:#9ECBFF"> install</span><span style="color:#9ECBFF"> bc</span><span style="color:#6A737D">                   # required for timeconst.h</span></span></code></pre>
<p>You can have a go at running just <code>make</code> from the <code>linux</code> folder at this point but various options need to be set and it’s probably easier to use <code>menuconfig</code>. Make sure you created the <code>.config</code> from earlier then run the following.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> linux</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> make</span><span style="color:#9ECBFF"> menuconfig</span></span></code></pre>
<p>Scan the options but as they’re based on your current settings (via <code>.config</code>), you should just be able to quit (<code>ESC</code>, <code>ESC</code>) and something like the following will be output.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">  HOSTCC</span><span style="color:#9ECBFF">  scripts/kconfig/mconf.o</span></span>
<span class="line"><span style="color:#B392F0">  HOSTCC</span><span style="color:#9ECBFF">  scripts/kconfig/zconf.tab.o</span></span>
<span class="line"><span style="color:#B392F0">  HOSTCC</span><span style="color:#9ECBFF">  scripts/kconfig/lxdialog/checklist.o</span></span>
<span class="line"><span style="color:#B392F0">  HOSTCC</span><span style="color:#9ECBFF">  scripts/kconfig/lxdialog/util.o</span></span>
<span class="line"><span style="color:#B392F0">  HOSTCC</span><span style="color:#9ECBFF">  scripts/kconfig/lxdialog/inputbox.o</span></span>
<span class="line"><span style="color:#B392F0">  HOSTCC</span><span style="color:#9ECBFF">  scripts/kconfig/lxdialog/textbox.o</span></span>
<span class="line"><span style="color:#B392F0">  HOSTCC</span><span style="color:#9ECBFF">  scripts/kconfig/lxdialog/yesno.o</span></span>
<span class="line"><span style="color:#B392F0">  HOSTCC</span><span style="color:#9ECBFF">  scripts/kconfig/lxdialog/menubox.o</span></span>
<span class="line"><span style="color:#B392F0">  HOSTLD</span><span style="color:#9ECBFF">  scripts/kconfig/mconf</span></span>
<span class="line"><span style="color:#B392F0">scripts/kconfig/mconf</span><span style="color:#9ECBFF">  Kconfig</span></span>
<span class="line"><span style="color:#B392F0">configuration</span><span style="color:#9ECBFF"> written</span><span style="color:#9ECBFF"> to</span><span style="color:#9ECBFF"> .config</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">***</span><span style="color:#E1E4E8"> End of the configuration.</span></span>
<span class="line"><span style="color:#F97583">***</span><span style="color:#E1E4E8"> Execute </span><span style="color:#9ECBFF">'make'</span><span style="color:#E1E4E8"> to start the build or try </span><span style="color:#9ECBFF">'make help'</span><span style="color:#E1E4E8">.</span></span></code></pre>
<p>The last remaining config files will have now been created, so you can do the actual build with;</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">make</span><span style="color:#9ECBFF"> ARCH=arm</span></span></code></pre>
<p>or as Avi P points out below if you’re running on a multi-core Pi like the Pi 2 or Pi 3;</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">make</span><span style="color:#79B8FF"> -j4</span><span style="color:#9ECBFF"> ARCH=arm</span></span></code></pre>
<p>This takes a while; on my Pi Zero, over 12 hours. There’s always the option to <a href="https://www.raspberrypi.org/documentation/linux/kernel/building.md">cross compile</a> if you’re in a hurry.</p>
<p>For extra background, I found an interesting guide on Stack Exchange about <a href="http://unix.stackexchange.com/questions/115620/configuring-compiling-and-installing-a-custom-linux-kernel/115621#115621.">Configuring, Compiling and Installing Kernels</a> (although we’re not going as far as installing the built kernel here).</p>
<h2 id="modify-the-driver">Modify the Driver</h2>
<p>This is the step that actually disables the LED on the dongle.</p>
<p>Locate the <code>autoconf.h</code> file in the drivers folder (<code>linux/drivers/net/wireless/rtl8192cu/include</code> or <code>linux/drivers/net/wireless/realtek/rtl8192cu/include</code> in newer linux versions) and comment out the <code>CONFIG_LED</code> macro definition. It should look like this when you’re done.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">//</span><span style="color:#6A737D"> #define CONFIG_LED           // &#x3C;-- comment this line out to disable LED</span></span>
<span class="line"><span style="color:#6A737D">#ifdef CONFIG_LED</span></span>
<span class="line"><span style="color:#6A737D">    #define CONFIG_SW_LED</span></span>
<span class="line"><span style="color:#6A737D">    #ifdef CONFIG_SW_LED</span></span>
<span class="line"><span style="color:#B392F0">        //#define</span><span style="color:#9ECBFF"> CONFIG_LED_HANDLED_BY_CMD_THREAD</span></span>
<span class="line"><span style="color:#6A737D">    #endif</span></span>
<span class="line"><span style="color:#6A737D">#endif // CONFIG_LED</span></span></code></pre>
<h2 id="compile-the-driver">Compile the Driver</h2>
<p>The dependencies should all be available now, so you’re ready to compile the driver. Compile from the location of driver source (probably <code>linux/drivers/net/wireless/rtl8192cu</code> or <code>linux/drivers/net/wireless/realtek/rtl8192cu</code>).</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> linux/drivers/net/wireless/realtek/rtl8192cu</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> make</span><span style="color:#9ECBFF"> ARCH=arm</span></span></code></pre>
<p>Again, use the <code>-j4</code> flag if you’re on a big boy Pi.</p>
<h2 id="test--install-the-driver">Test &#x26; Install the Driver</h2>
<p>Once it’s compiled, remove the old driver with <code>sudo rmmod 8192cu</code> and from the driver folder, manually startup the newly compiled one; <code>sudo insmod 8192cu.ko</code>. Note that you’ll loose network connectivity after removing the old module. Make sure you’ve got a way to connect back to your Pi (like a <a href="/blog/2015-12-28-pi-console-lead/">console cable</a>).</p>
<p>Running <code>modinfo 8192cu</code> doesn’t help verify the new driver as none of the meta-data has changed but you can check the datestamp of the <code>.ko</code> and you should see that there’s no LED flashing.</p>
<p>To keep the change, I renamed the patched module to <code>8192cu-no-led.ko</code> and copied it into the Pi’s main kernel drivers folder. I renamed the original driver to <code>8192cu-original.ko</code> and created a symbolic link for the true module name <code>8192cu.ko</code>. This is because I want to be able to swtich back easily and not have to modify any additional configuration (for example, any <code>/etc/modprobe.d/8219cu.conf</code> settings) or black lists.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> mv</span><span style="color:#9ECBFF"> 8192cu.ko</span><span style="color:#9ECBFF"> 8192cu-no-led.ko</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> sudo</span><span style="color:#9ECBFF"> cp</span><span style="color:#9ECBFF"> 8192cu-no-led.ko</span><span style="color:#9ECBFF"> /lib/modules/4.1.13+/kernel/drivers/net/wireless/rtl8192cu/</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> /lib/modules/4.1.13+/kernel/drivers/net/wireless/rtl8192cu/</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> sudo</span><span style="color:#9ECBFF"> mv</span><span style="color:#9ECBFF"> 8192cu.ko</span><span style="color:#9ECBFF"> 8192cu-original.ko</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> sudo</span><span style="color:#9ECBFF"> ln</span><span style="color:#79B8FF"> -s</span><span style="color:#9ECBFF"> 8192cu-no-led.ko</span><span style="color:#9ECBFF"> 8192cu.ko</span></span></code></pre>
<p>You should see something like this.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> ll</span></span>
<span class="line"><span style="color:#B392F0">total</span><span style="color:#79B8FF"> 1332</span></span>
<span class="line"><span style="color:#B392F0">lrwxrwxrwx</span><span style="color:#79B8FF"> 1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#79B8FF">     13</span><span style="color:#9ECBFF"> Jan</span><span style="color:#79B8FF"> 12</span><span style="color:#9ECBFF"> 17:58</span><span style="color:#9ECBFF"> 8192cu.ko</span><span style="color:#E1E4E8"> -</span><span style="color:#F97583">></span><span style="color:#9ECBFF"> 8192cu-no-led.ko</span></span>
<span class="line"><span style="color:#B392F0">-rw-r--r--</span><span style="color:#79B8FF"> 1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#79B8FF"> 672500</span><span style="color:#9ECBFF"> Jan</span><span style="color:#79B8FF"> 12</span><span style="color:#9ECBFF"> 17:58</span><span style="color:#9ECBFF"> 8192cu-no-led.ko</span></span>
<span class="line"><span style="color:#B392F0">-rw-r--r--</span><span style="color:#79B8FF"> 1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#79B8FF"> 686160</span><span style="color:#9ECBFF"> Nov</span><span style="color:#79B8FF"> 18</span><span style="color:#9ECBFF"> 16:01</span><span style="color:#9ECBFF"> 8192cu-original.ko</span></span></code></pre>
<p>You can enable the original driver by reassigning the symbolic link.</p>
<h2 id="common-problems">Common Problems</h2>
<h3 id="no-armv6l-folder">No <code>armv6l</code> folder</h3>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> linux/arch</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> sudo</span><span style="color:#9ECBFF"> ln</span><span style="color:#79B8FF"> -s</span><span style="color:#9ECBFF"> arm</span><span style="color:#9ECBFF"> armv6l</span></span></code></pre>
<p>or always run the following when compiling</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">make</span><span style="color:#9ECBFF"> ARCH=arm</span></span></code></pre>
<h2 id="no-build-folder">No <code>build</code> folder</h2>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> make[1]:</span><span style="color:#79B8FF"> ***</span><span style="color:#9ECBFF"> /lib/modules/4.9.58+/build:</span><span style="color:#9ECBFF"> No</span><span style="color:#9ECBFF"> such</span><span style="color:#9ECBFF"> file</span><span style="color:#9ECBFF"> or</span><span style="color:#9ECBFF"> directory.</span><span style="color:#9ECBFF">  Stop.</span></span></code></pre>
<p>Create a sym</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> sudo</span><span style="color:#9ECBFF"> ln</span><span style="color:#79B8FF"> -s</span><span style="color:#9ECBFF"> /home/pi/code/linux</span><span style="color:#9ECBFF"> build</span></span></code></pre>
<p>The folder should look something like this.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> ll</span></span>
<span class="line"><span style="color:#B392F0">total</span><span style="color:#9ECBFF"> 1.9M</span></span>
<span class="line"><span style="color:#B392F0">drwxr-xr-x</span><span style="color:#79B8FF"> 11</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> 4.0K</span><span style="color:#9ECBFF"> Oct</span><span style="color:#79B8FF"> 27</span><span style="color:#9ECBFF"> 18:52</span><span style="color:#9ECBFF"> kernel</span></span>
<span class="line"><span style="color:#B392F0">lrwxrwxrwx</span><span style="color:#79B8FF">  1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#79B8FF">   19</span><span style="color:#9ECBFF"> Oct</span><span style="color:#79B8FF"> 29</span><span style="color:#9ECBFF"> 11:33</span><span style="color:#9ECBFF"> build</span><span style="color:#E1E4E8"> -</span><span style="color:#F97583">></span><span style="color:#9ECBFF"> /home/pi/code/linux</span></span>
<span class="line"><span style="color:#B392F0">-rw-r--r--</span><span style="color:#79B8FF">  1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> 471K</span><span style="color:#9ECBFF"> Oct</span><span style="color:#79B8FF"> 27</span><span style="color:#9ECBFF"> 18:53</span><span style="color:#9ECBFF"> modules.alias</span></span>
<span class="line"><span style="color:#B392F0">-rw-r--r--</span><span style="color:#79B8FF">  1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> 486K</span><span style="color:#9ECBFF"> Oct</span><span style="color:#79B8FF"> 27</span><span style="color:#9ECBFF"> 18:53</span><span style="color:#9ECBFF"> modules.alias.bin</span></span>
<span class="line"><span style="color:#B392F0">-rw-r--r--</span><span style="color:#79B8FF">  1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> 4.7K</span><span style="color:#9ECBFF"> Oct</span><span style="color:#79B8FF"> 27</span><span style="color:#9ECBFF"> 18:52</span><span style="color:#9ECBFF"> modules.builtin</span></span>
<span class="line"><span style="color:#79B8FF">...</span></span>
<span class="line"><span style="color:#B392F0">-rw-r--r--</span><span style="color:#79B8FF">  1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> 249K</span><span style="color:#9ECBFF"> Oct</span><span style="color:#79B8FF"> 27</span><span style="color:#9ECBFF"> 18:53</span><span style="color:#9ECBFF"> modules.symbols.bin</span></span></code></pre>
<h3 id="edimax-sleeps-and-drops-the-network">Edimax Sleeps and Drops the Network</h3>
<p>Setup some config in the <code>modprobe.d</code> folder.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cd</span><span style="color:#9ECBFF"> /etc/modprobe.d/</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> ll</span></span>
<span class="line"><span style="color:#B392F0">total</span><span style="color:#79B8FF"> 16</span></span>
<span class="line"><span style="color:#B392F0">-rw-r--r--</span><span style="color:#79B8FF"> 1</span><span style="color:#9ECBFF"> root</span><span style="color:#9ECBFF"> root</span><span style="color:#79B8FF">  73</span><span style="color:#9ECBFF"> Jan</span><span style="color:#79B8FF">  1</span><span style="color:#9ECBFF"> 19:45</span><span style="color:#9ECBFF"> 8192cu.conf</span></span>
<span class="line"><span style="color:#B392F0">$</span><span style="color:#9ECBFF"> cat</span><span style="color:#9ECBFF"> 8192cu.conf</span></span>
<span class="line"><span style="color:#B392F0">options</span><span style="color:#9ECBFF"> 8192cu</span><span style="color:#9ECBFF"> rtw_power_mgnt=</span><span style="color:#79B8FF">0</span><span style="color:#9ECBFF"> rtw_enusbss=</span><span style="color:#79B8FF">0</span></span></code></pre>  </div> </article> </div>  </main> <footer class="py-8 border-t border-gray-200 mt-12"> <div class="container mx-auto px-4 text-center"> <p class="text-xs text-gray-600">&copy; 2008-2026 Toby Weston. All rights reserved. (see some old <a class="text-gray-600 hover:text-sky-600" href="/code/">code</a>)</p> </div> </footer> </body></html>