<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Astro v5.18.0"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><!-- Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-1PVLDLDJQN"></script><script>(function(){const gaId = "G-1PVLDLDJQN";

      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', gaId);
    })();</script><!-- Canonical URL --><link rel="canonical" href="https://baddotrobot.com/blog/2009-02-16-more-on-micro-dsls/"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="bad.robot" href="/rss.xml"><!-- Primary Meta Tags --><title>More on Micro DSLs</title><meta name="title" content="More on Micro DSLs"><meta name="description" content="Another micro-DSL example: a fluent find-in-list API. Shows how to build a natural, readable DSL for searching heterogeneous collections in Java."><meta name="keywords" content="micro-DSL, fluent API, domain-specific language, Java, method chaining, collections, type-safe"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://baddotrobot.com/blog/2009-02-16-more-on-micro-dsls/"><meta property="og:title" content="More on Micro DSLs"><meta property="og:description" content="Another micro-DSL example: a fluent find-in-list API. Shows how to build a natural, readable DSL for searching heterogeneous collections in Java."><meta property="og:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><meta property="og:site_name" content="bad.robot"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://baddotrobot.com/blog/2009-02-16-more-on-micro-dsls/"><meta property="twitter:title" content="More on Micro DSLs"><meta property="twitter:description" content="Another micro-DSL example: a fluent find-in-list API. Shows how to build a natural, readable DSL for searching heterogeneous collections in Java."><meta property="twitter:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"More on Micro DSLs","description":"Another micro-DSL example: a fluent find-in-list API. Shows how to build a natural, readable DSL for searching heterogeneous collections in Java.","datePublished":"2009-02-16T00:00:00.000Z","url":"https://baddotrobot.com/blog/2009-02-16-more-on-micro-dsls/","author":{"@type":"Person","name":"Toby Weston","url":"https://baddotrobot.com"},"publisher":{"@type":"Person","name":"bad.robot"}}</script><link rel="stylesheet" href="/_astro/index.BiihJROh.css">
<style>.giscus-wrapper[data-astro-cid-2s6z27su]{margin-top:3rem;padding-top:0}.giscus-divider[data-astro-cid-2s6z27su]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.giscus-divider[data-astro-cid-2s6z27su]:before,.giscus-divider[data-astro-cid-2s6z27su]:after{content:"";flex:1;height:1px;background:var(--border)}.giscus-divider-label[data-astro-cid-2s6z27su]{text-transform:uppercase;letter-spacing:.2em;color:var(--accent);font-size:.75rem;font-weight:600;white-space:nowrap}.giscus[data-astro-cid-2s6z27su],.giscus-frame[data-astro-cid-2s6z27su]{width:100%}
</style>
<link rel="stylesheet" href="/_astro/_slug_.Bryw6KM9.css"><style>img[data-astro-cid-hgbazjtb]{max-width:100%;height:auto}img[data-astro-cid-hgbazjtb].right{float:right;margin:0 0 1.5rem 1.5rem;max-width:50%}img[data-astro-cid-hgbazjtb].left{float:left;margin:0 1.5rem 1.5rem 0;max-width:50%}img[data-astro-cid-hgbazjtb].center{display:block;margin:1.5rem auto}img[data-astro-cid-hgbazjtb].half{max-width:48%}@media (max-width: 768px){img[data-astro-cid-hgbazjtb].right,img[data-astro-cid-hgbazjtb].left{float:none;display:block;margin:1.5rem auto;max-width:100%}}
</style></head> <body class="bg-white text-gray-900"> <header class="header" data-astro-cid-3ef6ksr2> <div class="header-container" data-astro-cid-3ef6ksr2> <div class="logo-section" data-astro-cid-3ef6ksr2> <a href="/" class="logo-link" data-astro-cid-3ef6ksr2> <img src="/_astro/robot-logo_105x132.N1ZQY9mA_Zj02tT.webp" alt="bad.robot logo" data-astro-cid-3ef6ksr2="true" loading="lazy" decoding="async" fetchpriority="auto" width="84" height="106" class="logo-image"> <div class="logo-text-block" data-astro-cid-3ef6ksr2> <h1 class="logo-title logo-text header-logo-text" data-astro-cid-3ef6ksr2>bad.robot</h1> <h2 class="logo-subtitle logo-subtitle-text header-subtitle" data-astro-cid-3ef6ksr2>good robots do what they&#39;re told</h2> </div> </a> </div> <nav class="nav" data-astro-cid-3ef6ksr2> <a href="/blog" data-astro-cid-3ef6ksr2>Blog</a> <a href="/book" data-astro-cid-3ef6ksr2>Books</a> <a href="/video" data-astro-cid-3ef6ksr2>Videos</a> <a href="/archive" data-astro-cid-3ef6ksr2>Archive</a> </nav> </div> </header>  <main id="site-main" class="mx-auto w-full max-w-6xl px-4 pt-4">   <div class="py-12"> <article class=""> <!--{heroImage && (--> <!--  <div class="hero-image mb-8">--> <!--    <img src={heroImage} alt={title} class="w-full h-auto rounded-lg shadow-lg" />--> <!--  </div>--> <!--)}--> <div class="article-title-section mb-8"> <p class="detail-kicker">Blog</p> <h1 class="article-title-section h1">More on Micro DSLs</h1>  <p class="article-description">Another micro-DSL example: a fluent find-in-list API. Shows how to build a natural, readable DSL for searching heterogeneous collections in Java.</p> </div> <div class="article-meta"> <div class="article-date"> <strong>Published:</strong> <time datetime="2009-02-16T00:00:00.000Z"> Feb 16, 2009 </time> </div>  </div> <div class="prose">  <p>I was recently talking about what I call <a href="/blog/2009-01-06-be-more-expressive-with-builders/">micro DSLs</a> and I thought I’d follow up with another example.</p>
<p>So, another example of a micro DSL I found myself writing is one of finding some object within a collection of differently typed objects. In my example, I want to find a <code>Race</code> object inside a bunch of calendar events objects, the finder micro DSL looks like this.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#F97583">final</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> RaceFinder</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    private</span><span style="color:#F97583"> final</span><span style="color:#E1E4E8"> Race race;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    private</span><span style="color:#B392F0"> RaceFinder</span><span style="color:#E1E4E8">(Race </span><span style="color:#FFAB70">race</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#79B8FF">        this</span><span style="color:#E1E4E8">.race </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> race;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">    static</span><span style="color:#E1E4E8"> RaceFinder </span><span style="color:#B392F0">find</span><span style="color:#E1E4E8">(Race </span><span style="color:#FFAB70">race</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> RaceFinder</span><span style="color:#E1E4E8">(race);</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">    CalendarEventEntry </span><span style="color:#B392F0">in</span><span style="color:#E1E4E8">(List&lt;</span><span style="color:#F97583">CalendarEventEntry</span><span style="color:#E1E4E8">&gt; </span><span style="color:#FFAB70">events</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">        for</span><span style="color:#E1E4E8"> (CalendarEventEntry event </span><span style="color:#F97583">:</span><span style="color:#E1E4E8"> events) {</span></span>
<span class="line"><span style="color:#F97583">            if</span><span style="color:#E1E4E8"> (race.</span><span style="color:#B392F0">getName</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">equals</span><span style="color:#E1E4E8">(event.</span><span style="color:#B392F0">getTitle</span><span style="color:#E1E4E8">().</span><span style="color:#B392F0">getPlainText</span><span style="color:#E1E4E8">())) {</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#E1E4E8"> event;</span></span>
<span class="line"><span style="color:#E1E4E8">            }</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> null</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>The way the class is built, it forces the client to use it such.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E1E4E8">CalendarEventEntry event </span><span style="color:#F97583">=</span><span style="color:#B392F0"> find</span><span style="color:#E1E4E8">(race).</span><span style="color:#B392F0">in</span><span style="color:#E1E4E8">(events);</span></span></code></pre>
<p>Where find is statically imported and race and events have been pre-populated.</p>
<p>The original version had a method in the class to do the find, in the context of this class it was harder to test the find. I had a bunch of mocks and I was testing the find function amongst other behaviours of the class. The search line looked something like this.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8;overflow-x:auto" tabindex="0" data-language="java"><code><span class="line"><span style="color:#E1E4E8">CalendarEventEntry event </span><span style="color:#F97583">=</span><span style="color:#B392F0"> searchForRaceIn</span><span style="color:#E1E4E8">(events);</span></span></code></pre>
<h2 id="whats-with-micro-dsl">What’s with “micro DSL”?</h2>
<p>Why I term this a micro DSL is that it has a very specific usage (to find a race within a calendar) and it has a <strong>private constructor</strong> and <strong>public static creation method</strong> to ensure strict usage. The real thing though is the <strong>method names don’t really do what they imply they’re going to do</strong>. The <code>in</code> method actually does the search, but the <code>find</code> method doesn’t do any such thing; it <em>creates</em> an object.</p>
<blockquote>
<p>Micro DSLs are recognisable by their tiny-domain, the way in which construction is done to ensure methods can only be called in a certain order that makes sense to the domain and badly named methods.</p>
</blockquote>
<p>How do you feel about this? When its used in a tiny domain like this and when it expresses the conversation more concisely than the alternatives, I feel pretty good about it. It makes me realise its not the words (method names) that are important, its the sentences they put together. So I’m compromising on realistic method names for more expressive sentences. The fact that the class prevents you from constructing invalid sentences just makes the warm feeling grow.</p>
<h2 id="recommended-reading">Recommended Reading</h2>
<ul>
<li><a href="http://www.amazon.co.uk/gp/product/0321712943/ref=as_li_ss_tl?ie=UTF8&camp=1634&creative=19450&creativeASIN=0321712943&linkCode=as2&tag=baddotrobot-21">Domain Specific Languages (Addison-Wesley Signature)</a>, Martin Fowler</li>
<li><a href="http://www.amazon.co.uk/gp/product/1935182455/ref=as_li_ss_tl?ie=UTF8&camp=1634&creative=19450&creativeASIN=1935182455&linkCode=as2&tag=baddotrobot-21">DSLs in Action</a>, DSLs in Action</li>
<li><a href="http://www.amazon.co.uk/gp/product/1934356999/ref=as_li_ss_tl?ie=UTF8&camp=1634&creative=19450&creativeASIN=1934356999&linkCode=as2&tag=baddotrobot-21">The Definitive ANTLR 4 Reference: Building Domain-Specific Languages (Pragmatic Programmers)</a>, Terence Parr</li>
</ul>  </div> <div class="giscus-wrapper" data-astro-cid-2s6z27su><div class="giscus-divider" data-astro-cid-2s6z27su><span class="giscus-divider-label" data-astro-cid-2s6z27su>Discussion</span></div><div class="giscus" id="giscus-container" data-astro-cid-2s6z27su></div></div><script type="module">const repo = "tobyweston/blog";
const repoId = "MDEwOlJlcG9zaXRvcnkzMzUyNTYw";
const category = "General";
const categoryId = "DIC_kwDOADMn8M4C3bWR";

    function loadGiscus() {
      const container = document.getElementById('giscus-container');
      if (!container) return;

      const script = document.createElement('script');
      script.src            = 'https://giscus.app/client.js';
      script.setAttribute('data-repo',              repo);
      script.setAttribute('data-repo-id',           repoId);
      script.setAttribute('data-category',          category);
      script.setAttribute('data-category-id',       categoryId);
      script.setAttribute('data-mapping',           'pathname');
      script.setAttribute('data-strict',            '0');
      script.setAttribute('data-reactions-enabled', '1');
      script.setAttribute('data-emit-metadata',     '0');
      script.setAttribute('data-input-position',    'top');
      script.setAttribute('data-theme',             'light');
      script.setAttribute('data-lang',              'en');
      script.setAttribute('data-loading',           'lazy');
      script.crossOrigin    = 'anonymous';
      script.async          = true;
      container.appendChild(script);
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadGiscus);
    } else {
      loadGiscus();
    }
  </script> </article> </div>  </main> <footer class="py-8 border-t border-gray-200 mt-12"> <div class="container mx-auto px-4 text-center"> <p class="text-xs text-gray-600">&copy; 2008-2026 Toby Weston. All rights reserved. (see some old <a class="text-gray-600 hover:text-sky-600" href="/code/">code</a>)</p> </div> </footer> </body></html>