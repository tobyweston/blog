<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Astro v5.18.0"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><!-- Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-1PVLDLDJQN"></script><script>(function(){const gaId = "G-1PVLDLDJQN";

      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', gaId);
    })();</script><!-- Canonical URL --><link rel="canonical" href="https://baddotrobot.com/blog/2016-08-13-type-classes/"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="bad.robot" href="/rss.xml"><!-- Primary Meta Tags --><title>Type Classes in Scala</title><meta name="title" content="Type Classes in Scala"><meta name="description" content="Type classes in Scala provide ad-hoc polymorphism without inheritance. Learn the pattern using implicits and understand when type classes beat traditional OOP."><meta name="keywords" content="Scala type classes, ad-hoc polymorphism, implicits, type class pattern, Scala, functional programming"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://baddotrobot.com/blog/2016-08-13-type-classes/"><meta property="og:title" content="Type Classes in Scala"><meta property="og:description" content="Type classes in Scala provide ad-hoc polymorphism without inheritance. Learn the pattern using implicits and understand when type classes beat traditional OOP."><meta property="og:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><meta property="og:site_name" content="bad.robot"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://baddotrobot.com/blog/2016-08-13-type-classes/"><meta property="twitter:title" content="Type Classes in Scala"><meta property="twitter:description" content="Type classes in Scala provide ad-hoc polymorphism without inheritance. Learn the pattern using implicits and understand when type classes beat traditional OOP."><meta property="twitter:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Type Classes in Scala","description":"Type classes in Scala provide ad-hoc polymorphism without inheritance. Learn the pattern using implicits and understand when type classes beat traditional OOP.","datePublished":"2016-08-13T00:00:00.000Z","image":"https://baddotrobot.com/images/heroes/functional-programming.jpg","url":"https://baddotrobot.com/blog/2016-08-13-type-classes/","author":{"@type":"Person","name":"Toby Weston","url":"https://baddotrobot.com"},"publisher":{"@type":"Person","name":"bad.robot"}}</script><link rel="stylesheet" href="/_astro/index.BiihJROh.css">
<style>.giscus-wrapper[data-astro-cid-2s6z27su]{margin-top:3rem;padding-top:0}.giscus-divider[data-astro-cid-2s6z27su]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.giscus-divider[data-astro-cid-2s6z27su]:before,.giscus-divider[data-astro-cid-2s6z27su]:after{content:"";flex:1;height:1px;background:var(--border)}.giscus-divider-label[data-astro-cid-2s6z27su]{text-transform:uppercase;letter-spacing:.2em;color:var(--accent);font-size:.75rem;font-weight:600;white-space:nowrap}.giscus[data-astro-cid-2s6z27su],.giscus-frame[data-astro-cid-2s6z27su]{width:100%}
</style>
<link rel="stylesheet" href="/_astro/_slug_.Bryw6KM9.css"></head> <body class="bg-white text-gray-900"> <header class="header" data-astro-cid-3ef6ksr2> <div class="header-container" data-astro-cid-3ef6ksr2> <div class="logo-section" data-astro-cid-3ef6ksr2> <a href="/" class="logo-link" data-astro-cid-3ef6ksr2> <img src="/_astro/robot-logo_105x132.N1ZQY9mA_Zj02tT.webp" alt="bad.robot logo" data-astro-cid-3ef6ksr2="true" loading="lazy" decoding="async" fetchpriority="auto" width="84" height="106" class="logo-image"> <div class="logo-text-block" data-astro-cid-3ef6ksr2> <h1 class="logo-title logo-text header-logo-text" data-astro-cid-3ef6ksr2>bad.robot</h1> <h2 class="logo-subtitle logo-subtitle-text header-subtitle" data-astro-cid-3ef6ksr2>good robots do what they&#39;re told</h2> </div> </a> </div> <nav class="nav" data-astro-cid-3ef6ksr2> <a href="/blog" data-astro-cid-3ef6ksr2>Blog</a> <a href="/book" data-astro-cid-3ef6ksr2>Books</a> <a href="/video" data-astro-cid-3ef6ksr2>Videos</a> <a href="/archive" data-astro-cid-3ef6ksr2>Archive</a> </nav> </div> </header>  <main id="site-main" class="mx-auto w-full max-w-6xl px-4 pt-4">   <div class="py-12"> <article class=""> <!--{heroImage && (--> <!--  <div class="hero-image mb-8">--> <!--    <img src={heroImage} alt={title} class="w-full h-auto rounded-lg shadow-lg" />--> <!--  </div>--> <!--)}--> <div class="article-title-section mb-8"> <p class="detail-kicker">Blog</p> <h1 class="article-title-section h1">Type Classes in Scala</h1>  <p class="article-description">Type classes in Scala provide ad-hoc polymorphism without inheritance. Learn the pattern using implicits and understand when type classes beat traditional OOP.</p> </div> <div class="article-meta"> <div class="article-date"> <strong>Published:</strong> <time datetime="2016-08-13T00:00:00.000Z"> Aug 13, 2016 </time> </div>  </div> <div class="prose">  <p>Type classes provide <a href="http://bit.ly/1kr6C8E#Ad_hoc_polymorphism">ad-hoc inheritance</a> which means that we can use them to create polymorphic functions that can be applied to arguments of different types. This is a fancy way of saying that we can create common behaviour for classes without resorting to traditional (<code>extends</code>) polymorphism.</p>
<p>From the <a href="http://danielwestheide.com/blog/2013/02/06/the-neophytes-guide-to-scala-part-12-type-classes.html">Neophytes Guide</a>, Daniel Westheide describes type classes, slightly paraphrased, as follows.</p>
<blockquote>
<p>A type class <code>C</code> defines behaviour.<br>
Type <code>T</code> must support behaviour defined in <code>C</code> to be a “member” of <code>C</code>.<br>
If <code>T</code> is a “member”, it isn”t inherent to that type (if <code>T</code> has <code>C</code>’s behaviour, it isn’t native to that type via <code>extends</code> or otherwise).<br>
Instead, anyone can supply implementations of <code>C</code> behaviour for type <code>T</code> and this infers that <code>T</code> is a “member” of <code>C</code>.</p>
</blockquote>
<h2 id="how-to-create-type-classes">How to Create Type Classes</h2>
<ol>
<li>Define behaviour <code>C</code> as a trait</li>
<li>Provide default implementations for your types (e.g. <code>T</code> above)</li>
<li>Call the behaviours of <code>C</code> in a common way (optionally extending “members” like <code>T</code> with implicit classes)</li>
</ol>
<h2 id="example-from-the-neophytes-guide">Example from the Neophytes Guide</h2>
<blockquote>
<p>The type class here is <code>NumberLike</code> providing abstract <code>plus</code>, <code>divide</code> and <code>minus</code> behaviours.<br>
Types <code>Int</code> and <code>Double</code> are “members” of <code>NumberLike</code>.<br>
<code>Int</code> and <code>Double</code> don’t natively have the behaviors of <code>NumberLike</code>.<br>
Instead, the implementations on the <code>NumberLike</code> object provides them.</p>
</blockquote>
<h3 id="step-1-define-behaviour-as-a-trait">Step 1: Define Behaviour (as a trait)</h3>
<p>Notice the paramaterised type <code>[T]</code>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">object</span><span style="color:#B392F0"> Example</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  trait</span><span style="color:#B392F0"> NumberLike</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">] {</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> plus</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> T</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> divide</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> T</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> minus</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> T</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="step-2-provide-implementations">Step 2: Provide Implementations</h3>
<p>Provide some default implementations of your type class trait in its companion object. Usually, these are singletons (<code>object</code>) but could be <code>val</code>s. They are <strong>always</strong> <code>implicit</code>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">object</span><span style="color:#B392F0"> NumberLike</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  implicit</span><span style="color:#F97583"> object</span><span style="color:#B392F0"> NumberLikeDouble</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> NumberLike</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">Double</span><span style="color:#E1E4E8">] {</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> plus</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Double</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Double</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Double</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> y</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> divide</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Double</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Double</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> y</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> minus</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Double</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Double</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Double</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> y</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">  </span></span>
<span class="line"><span style="color:#F97583">  implicit</span><span style="color:#F97583"> object</span><span style="color:#B392F0"> NumberLikeInt</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> NumberLike</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">] {</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> plus</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Int</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">+</span><span style="color:#E1E4E8"> y</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> divide</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Int</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">/</span><span style="color:#E1E4E8"> y</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> minus</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">x</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">, </span><span style="color:#FFAB70">y</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Int</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> x </span><span style="color:#F97583">-</span><span style="color:#E1E4E8"> y</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="step-3a-call-the-type-class">Step 3a. Call the Type Class</h3>
<p>The whole point of the pattern is to be able to provide common behaviour to classes without tight coupling or even by modifying them at all. So far, we’ve created specific behaviours for our classes (like <code>plus</code> above) conforming to our “contract” type class <code>C</code>.</p>
<p>To call that behaviour, we use Scala’s <code>implicit</code> semantics to find an appropriate implementation. It binds a concrete type of <code>T</code> (let’s say <code>Int</code>) with it’s corresponding type class (<code>NumberLikeInt</code>). It means we only need one method for all number-like types.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">object</span><span style="color:#B392F0"> Statistics</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  def</span><span style="color:#B392F0"> mean</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">](</span><span style="color:#FFAB70">numbers</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Seq</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">])(</span><span style="color:#F97583">implicit</span><span style="color:#FFAB70"> number</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">NumberLike</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">])</span><span style="color:#F97583">:</span><span style="color:#B392F0"> T</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    number.divide(numbers.reduce(number.plus), numbers.size)</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>So, if an implicit parameter can be found for a given type, Scala will use that implementation. The <code>NumberLikeInt</code> is used below.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">scala</span><span style="color:#E1E4E8">> </span><span style="color:#9ECBFF">println</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">Statistics.mean(List[Int](1,</span><span style="color:#9ECBFF"> 2,</span><span style="color:#9ECBFF"> 3,</span><span style="color:#9ECBFF"> 6,</span><span style="color:#79B8FF"> 8</span><span style="color:#E1E4E8">)))</span></span>
<span class="line"><span style="color:#B392F0">4</span></span></code></pre>
<p>Without an implicit in scope, you’d get an error</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#B392F0">Error:(42,</span><span style="color:#79B8FF"> 26</span><span style="color:#E1E4E8">) could not find implicit value </span><span style="color:#F97583">for</span><span style="color:#E1E4E8"> parameter number: NumberLike[Int]</span></span>
<span class="line"><span style="color:#B392F0">  println(Statistics.mean(Seq(1,</span><span style="color:#9ECBFF"> 2,</span><span style="color:#9ECBFF"> 3,</span><span style="color:#9ECBFF"> 6,</span><span style="color:#79B8FF"> 8</span><span style="color:#E1E4E8">)))</span></span></code></pre>
<h4 id="context-bounds">Context Bounds</h4>
<p>Another way of writing the generic method is to use context bounds (ie, use <code>T: NumberLike</code>).</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">object</span><span style="color:#B392F0"> Statistics</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  def</span><span style="color:#B392F0"> mean</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#F97583">:</span><span style="color:#B392F0"> NumberLike</span><span style="color:#E1E4E8">](</span><span style="color:#FFAB70">numbers</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Seq</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    val</span><span style="color:#FFAB70"> number</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> implicitly[</span><span style="color:#B392F0">NumberLike</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">]]</span></span>
<span class="line"><span style="color:#E1E4E8">    number.divide(numbers.reduce(number.plus), numbers.size)</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="step-3b-call-the-type-class-with-an-implicit-class">Step 3b. Call the Type Class (with an Implicit Class)</h3>
<p>As a simple extension, you can extend “member” types directly using an <code>implicit</code> class. For example, we can add the <code>mean</code> method to any sequence of <code>NumberLike</code>s.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">implicit</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> SeqNumberOps</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">](</span><span style="color:#FFAB70">numbers</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">Seq</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">]) {</span></span>
<span class="line"><span style="color:#F97583">  def</span><span style="color:#B392F0"> mean</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">implicit</span><span style="color:#FFAB70"> number</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">NumberLike</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">T</span><span style="color:#E1E4E8">])</span><span style="color:#F97583">:</span><span style="color:#B392F0"> T</span><span style="color:#F97583"> =</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">    number.divide(numbers.reduce(number.plus), numbers.size)</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>and call <code>mean</code> directly.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#B392F0"> NumberOps</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">val</span><span style="color:#FFAB70"> numbers</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> List</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">Int</span><span style="color:#E1E4E8">](</span><span style="color:#79B8FF">1</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">32</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">43</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">println(numbers.mean)</span></span></code></pre>
<p>or like this for <code>Double</code>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">val</span><span style="color:#FFAB70"> numbers</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> List</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">Double</span><span style="color:#E1E4E8">](</span><span style="color:#79B8FF">3.2</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4.2</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">3.0</span><span style="color:#E1E4E8">, </span><span style="color:#79B8FF">4.4</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">println(numbers.mean)</span></span></code></pre>
<h2 id="another-example">Another Example</h2>
<h3 id="step-1-define-behaviour">Step 1: Define Behaviour</h3>
<p>A basic “decoder” interface that uses an <code>Either</code> to return a result as either successful or unsuccessful.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">trait</span><span style="color:#B392F0"> StringDecoder</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">A</span><span style="color:#E1E4E8">] {</span></span>
<span class="line"><span style="color:#F97583">  def</span><span style="color:#B392F0"> fromString</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">string</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">String</span><span style="color:#E1E4E8">)</span><span style="color:#F97583">:</span><span style="color:#B392F0"> Either</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">String</span><span style="color:#E1E4E8">, </span><span style="color:#B392F0">A</span><span style="color:#E1E4E8">]</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="step-2-provide-implementations-1">Step 2: Provide Implementations</h3>
<p>We could provide an implementation to decode a string to a valid <code>Colour</code> type. Unsupported colours produce a “left” result.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">implicit</span><span style="color:#F97583"> val</span><span style="color:#FFAB70"> colourTypeStringDecoder</span><span style="color:#F97583"> =</span><span style="color:#F97583"> new</span><span style="color:#B392F0"> StringDecoder</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">Colour</span><span style="color:#E1E4E8">] {</span></span>
<span class="line"><span style="color:#F97583">  def</span><span style="color:#B392F0"> fromString</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">value</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">String</span><span style="color:#E1E4E8">) </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    val</span><span style="color:#FFAB70"> colours</span><span style="color:#F97583"> =</span><span style="color:#B392F0"> List</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"red"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"green"</span><span style="color:#E1E4E8">, </span><span style="color:#9ECBFF">"yellow"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#F97583">      if</span><span style="color:#E1E4E8"> (colours.contains(value)) </span><span style="color:#B392F0">Right</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">Colour</span><span style="color:#E1E4E8">(value)) </span></span>
<span class="line"><span style="color:#F97583">      else</span><span style="color:#B392F0"> Left</span><span style="color:#E1E4E8">(</span><span style="color:#F97583">s</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">$value</span><span style="color:#9ECBFF"> is not a valid colour, chose one of </span><span style="color:#E1E4E8">${colours.mkString(</span><span style="color:#9ECBFF">", "</span><span style="color:#E1E4E8">)}</span><span style="color:#9ECBFF">"</span><span style="color:#E1E4E8">)</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h3 id="step-3-call-the-type-classes">Step 3. Call the Type Classes</h3>
<p>With an implicit class extending <code>String</code>, any string value can be decoded to a type <code>A</code>.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#F97583">object</span><span style="color:#B392F0"> StringSyntax</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">  implicit</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> StringDecoderOps</span><span style="color:#E1E4E8">(</span><span style="color:#FFAB70">value</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">String</span><span style="color:#E1E4E8">) {</span></span>
<span class="line"><span style="color:#F97583">    def</span><span style="color:#B392F0"> decodeTo</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">A</span><span style="color:#E1E4E8">](</span><span style="color:#F97583">implicit</span><span style="color:#FFAB70"> decoder</span><span style="color:#E1E4E8">: </span><span style="color:#B392F0">StringDecoder</span><span style="color:#E1E4E8">[</span><span style="color:#B392F0">A</span><span style="color:#E1E4E8">]) </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#E1E4E8">      decoder.fromString(value)</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">  }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<p>Then anywhere you have a string and you want to decode it, just go ahead.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="scala"><code><span class="line"><span style="color:#9ECBFF">"red"</span><span style="color:#E1E4E8">.decodeTo[</span><span style="color:#B392F0">Colour</span><span style="color:#E1E4E8">]      </span><span style="color:#6A737D">// right</span></span>
<span class="line"><span style="color:#9ECBFF">"square"</span><span style="color:#E1E4E8">.decodeTo[</span><span style="color:#B392F0">Colour</span><span style="color:#E1E4E8">]   </span><span style="color:#6A737D">// Left(square is not a valid colour, chose one of red, green, yellow)</span></span></code></pre>  </div> <div class="giscus-wrapper" data-astro-cid-2s6z27su><div class="giscus-divider" data-astro-cid-2s6z27su><span class="giscus-divider-label" data-astro-cid-2s6z27su>Discussion</span></div><div class="giscus" id="giscus-container" data-astro-cid-2s6z27su></div></div><script type="module">const repo = "tobyweston/blog";
const repoId = "MDEwOlJlcG9zaXRvcnkzMzUyNTYw";
const category = "General";
const categoryId = "DIC_kwDOADMn8M4C3bWR";

    function loadGiscus() {
      const container = document.getElementById('giscus-container');
      if (!container) return;

      const script = document.createElement('script');
      script.src            = 'https://giscus.app/client.js';
      script.setAttribute('data-repo',              repo);
      script.setAttribute('data-repo-id',           repoId);
      script.setAttribute('data-category',          category);
      script.setAttribute('data-category-id',       categoryId);
      script.setAttribute('data-mapping',           'pathname');
      script.setAttribute('data-strict',            '0');
      script.setAttribute('data-reactions-enabled', '1');
      script.setAttribute('data-emit-metadata',     '0');
      script.setAttribute('data-input-position',    'top');
      script.setAttribute('data-theme',             'light');
      script.setAttribute('data-lang',              'en');
      script.setAttribute('data-loading',           'lazy');
      script.crossOrigin    = 'anonymous';
      script.async          = true;
      container.appendChild(script);
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadGiscus);
    } else {
      loadGiscus();
    }
  </script> </article> </div>  </main> <footer class="py-8 border-t border-gray-200 mt-12"> <div class="container mx-auto px-4 text-center"> <p class="text-xs text-gray-600">&copy; 2008-2026 Toby Weston. All rights reserved. (see some old <a class="text-gray-600 hover:text-sky-600" href="/code/">code</a>)</p> </div> </footer> </body></html>