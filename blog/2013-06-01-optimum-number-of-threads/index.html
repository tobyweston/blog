<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="generator" content="Astro v5.18.0"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><!-- Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-1PVLDLDJQN"></script><script>(function(){const gaId = "G-1PVLDLDJQN";

      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', gaId);
    })();</script><!-- Canonical URL --><link rel="canonical" href="https://baddotrobot.com/blog/2013-06-01-optimum-number-of-threads/"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="bad.robot" href="/rss.xml"><!-- Primary Meta Tags --><title>Calculate the Optimum Number of Threads</title><meta name="title" content="Calculate the Optimum Number of Threads"><meta name="description" content="Calculate the optimal number of threads for a Java application. Covers CPU-bound vs IO-bound workloads and the formula for sizing thread pools correctly."><meta name="keywords" content="Java threads, optimal thread count, CPU-bound, IO-bound, thread pool, concurrency, performance"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://baddotrobot.com/blog/2013-06-01-optimum-number-of-threads/"><meta property="og:title" content="Calculate the Optimum Number of Threads"><meta property="og:description" content="Calculate the optimal number of threads for a Java application. Covers CPU-bound vs IO-bound workloads and the formula for sizing thread pools correctly."><meta property="og:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><meta property="og:site_name" content="bad.robot"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://baddotrobot.com/blog/2013-06-01-optimum-number-of-threads/"><meta property="twitter:title" content="Calculate the Optimum Number of Threads"><meta property="twitter:description" content="Calculate the optimal number of threads for a Java application. Covers CPU-bound vs IO-bound workloads and the formula for sizing thread pools correctly."><meta property="twitter:image" content="https://baddotrobot.com/images/heroes/java-code.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Calculate the Optimum Number of Threads","description":"Calculate the optimal number of threads for a Java application. Covers CPU-bound vs IO-bound workloads and the formula for sizing thread pools correctly.","datePublished":"2013-06-01T00:00:00.000Z","image":"https://baddotrobot.com/images/heroes/performance.jpg","url":"https://baddotrobot.com/blog/2013-06-01-optimum-number-of-threads/","author":{"@type":"Person","name":"Toby Weston","url":"https://baddotrobot.com"},"publisher":{"@type":"Person","name":"bad.robot"}}</script><link rel="stylesheet" href="/_astro/index.BiihJROh.css">
<style>.giscus-wrapper[data-astro-cid-2s6z27su]{margin-top:3rem;padding-top:0}.giscus-divider[data-astro-cid-2s6z27su]{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem}.giscus-divider[data-astro-cid-2s6z27su]:before,.giscus-divider[data-astro-cid-2s6z27su]:after{content:"";flex:1;height:1px;background:var(--border)}.giscus-divider-label[data-astro-cid-2s6z27su]{text-transform:uppercase;letter-spacing:.2em;color:var(--accent);font-size:.75rem;font-weight:600;white-space:nowrap}.giscus[data-astro-cid-2s6z27su],.giscus-frame[data-astro-cid-2s6z27su]{width:100%}
</style>
<link rel="stylesheet" href="/_astro/_slug_.Bryw6KM9.css"></head> <body class="bg-white text-gray-900"> <header class="header" data-astro-cid-3ef6ksr2> <div class="header-container" data-astro-cid-3ef6ksr2> <div class="logo-section" data-astro-cid-3ef6ksr2> <a href="/" class="logo-link" data-astro-cid-3ef6ksr2> <img src="/_astro/robot-logo_105x132.N1ZQY9mA_Zj02tT.webp" alt="bad.robot logo" data-astro-cid-3ef6ksr2="true" loading="lazy" decoding="async" fetchpriority="auto" width="84" height="106" class="logo-image"> <div class="logo-text-block" data-astro-cid-3ef6ksr2> <h1 class="logo-title logo-text header-logo-text" data-astro-cid-3ef6ksr2>bad.robot</h1> <h2 class="logo-subtitle logo-subtitle-text header-subtitle" data-astro-cid-3ef6ksr2>good robots do what they&#39;re told</h2> </div> </a> </div> <nav class="nav" data-astro-cid-3ef6ksr2> <a href="/blog" data-astro-cid-3ef6ksr2>Blog</a> <a href="/book" data-astro-cid-3ef6ksr2>Books</a> <a href="/video" data-astro-cid-3ef6ksr2>Videos</a> <a href="/archive" data-astro-cid-3ef6ksr2>Archive</a> </nav> </div> </header>  <main id="site-main" class="mx-auto w-full max-w-6xl px-4 pt-4">   <div class="py-12"> <article class=""> <!--{heroImage && (--> <!--  <div class="hero-image mb-8">--> <!--    <img src={heroImage} alt={title} class="w-full h-auto rounded-lg shadow-lg" />--> <!--  </div>--> <!--)}--> <div class="article-title-section mb-8"> <p class="detail-kicker">Blog</p> <h1 class="article-title-section h1">Calculate the Optimum Number of Threads</h1>  <p class="article-description">Calculate the optimal number of threads for a Java application. Covers CPU-bound vs IO-bound workloads and the formula for sizing thread pools correctly.</p> </div> <div class="article-meta"> <div class="article-date"> <strong>Published:</strong> <time datetime="2013-06-01T00:00:00.000Z"> Jun 1, 2013 </time> </div>  </div> <div class="prose">  <p>Working out the theoretical optimal number of threads you should use for your application is fairly straightforward. You do, however, need to understand your applications runtime characteristics. Is it mostly occupied with CPU intensive work or is it mostly waiting for IO?</p>
<p>In this post, we look at how to work out a good thread pool size for your CPU and IO based tasks.</p>
<h2 id="cpu-bound-tasks">CPU Bound Tasks</h2>
<p>For CPU bound tasks, Goetz (2002, 2006) recommends</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">threads</span><span style="color:#9ECBFF"> =</span><span style="color:#9ECBFF"> number</span><span style="color:#9ECBFF"> of</span><span style="color:#9ECBFF"> CPUs</span><span style="color:#9ECBFF"> +</span><span style="color:#79B8FF"> 1</span></span></code></pre>
<p>Which is intuitive as if a CPU is being kept busy, we can’t do more work than the number of CPUs. Goetz purports that the additional CPU has been shown as an improvement over omitting it (2006), but others don’t agree and suggest just the number of CPUs is optimal.</p>
<h2 id="io-bound-tasks">IO Bound Tasks</h2>
<p>Working out the optimal number for IO bound tasks is less obvious. During an IO bound task, a CPU will be left idle (waiting or blocking). This idle time can be better used in initiating another IO bound request.</p>
<p>Subramaniam (2011, p.31) describes the optimal number of threads in terms of the following formula.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">threads</span><span style="color:#9ECBFF"> =</span><span style="color:#9ECBFF"> number</span><span style="color:#9ECBFF"> of</span><span style="color:#9ECBFF"> cores</span><span style="color:#9ECBFF"> /</span><span style="color:#E1E4E8">  (1 </span><span style="color:#9ECBFF">–</span><span style="color:#9ECBFF"> blocking</span><span style="color:#9ECBFF"> coefficient</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="78" height="33" src="/_astro/subramaniam.DBalVZ7-_Z2v64o5.webp" ></p>
<p>And Goetz (2002) describes the optimal number of threads in terms of the following.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="shell"><code><span class="line"><span style="color:#B392F0">threads</span><span style="color:#9ECBFF"> =</span><span style="color:#9ECBFF"> number</span><span style="color:#9ECBFF"> of</span><span style="color:#9ECBFF"> cores</span><span style="color:#79B8FF"> *</span><span style="color:#E1E4E8"> (1 </span><span style="color:#9ECBFF">+</span><span style="color:#9ECBFF"> wait</span><span style="color:#9ECBFF"> time</span><span style="color:#9ECBFF"> /</span><span style="color:#9ECBFF"> service</span><span style="color:#9ECBFF"> time</span><span style="color:#E1E4E8">)</span></span></code></pre>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="108" height="34" src="/_astro/goetz-1.BB9MY7DV_Z2VoTI.webp" ></p>
<p>Where we can think of <code>wait time / service time</code> as a measure of how contended the task is.</p>
<h2 id="goetz-and-subramaniam-agree">Goetz and Subramaniam Agree</h2>
<p>Just out of interest, we can show that both IO bound formulas are equivalent. Starting with Goetz’s formula, we assert that <code>w+s=1</code> and remove the service time (<code>s</code>) giving the following</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="144" height="44" src="/_astro/goetz-2.BK5wvx2n_Z1cR24G.webp" ></p>
<p>We can continue by multiplying both sides by <code>1-w</code> reducing the right hand side to <code>c</code> before reversing the operation and revealing Subramaniam’s expression.</p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="195" height="19" src="/_astro/goetz-3.DRxPQ9PS_24eTqW.webp" ></p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="100" height="19" src="/_astro/goetz-4.D1m0AbCe_gc8PH.webp" ></p>
<p><img  loading="lazy" decoding="async" fetchpriority="auto" width="78" height="33" src="/_astro/subramaniam.DBalVZ7-_Z2v64o5.webp" ></p>
<p>This post originally appeared on my concurrency library <a href="http://tempusfugitlibrary.org/">tempus-fugit</a>’s project site.</p>
<h2 id="references">References</h2>
<ul>
<li>Goetz, B. 2002. <a href="http://www.ibm.com/developerworks/java/library/j-jtp0730/index.html">Java theory and practice: Thread pools and work queues</a>. IBM DeveloperWorks.</li>
<li>Goetz, B. Peierls, T. Bloch, J. Bowbeer, J. Holmes, D. and Lea, D. 2006. <a href="http://amzn.to/NrXQPZ">Java Concurrency in Practice</a>. 1st Edition. Addison Wesley.</li>
<li>Subramaniam, V. 2011. <a href="http://amzn.to/NrXXuI">Programming Concurrency on the JVM</a>. 1st Edition. Pragmatic Bookshelf.</li>
</ul>  </div> <div class="giscus-wrapper" data-astro-cid-2s6z27su><div class="giscus-divider" data-astro-cid-2s6z27su><span class="giscus-divider-label" data-astro-cid-2s6z27su>Discussion</span></div><div class="giscus" id="giscus-container" data-astro-cid-2s6z27su></div></div><script type="module">const repo = "tobyweston/blog";
const repoId = "MDEwOlJlcG9zaXRvcnkzMzUyNTYw";
const category = "General";
const categoryId = "DIC_kwDOADMn8M4C3bWR";

    function loadGiscus() {
      const container = document.getElementById('giscus-container');
      if (!container) return;

      const script = document.createElement('script');
      script.src            = 'https://giscus.app/client.js';
      script.setAttribute('data-repo',              repo);
      script.setAttribute('data-repo-id',           repoId);
      script.setAttribute('data-category',          category);
      script.setAttribute('data-category-id',       categoryId);
      script.setAttribute('data-mapping',           'pathname');
      script.setAttribute('data-strict',            '0');
      script.setAttribute('data-reactions-enabled', '1');
      script.setAttribute('data-emit-metadata',     '0');
      script.setAttribute('data-input-position',    'top');
      script.setAttribute('data-theme',             'light');
      script.setAttribute('data-lang',              'en');
      script.setAttribute('data-loading',           'lazy');
      script.crossOrigin    = 'anonymous';
      script.async          = true;
      container.appendChild(script);
    }

    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadGiscus);
    } else {
      loadGiscus();
    }
  </script> </article> </div>  </main> <footer class="py-8 border-t border-gray-200 mt-12"> <div class="container mx-auto px-4 text-center"> <p class="text-xs text-gray-600">&copy; 2008-2026 Toby Weston. All rights reserved. (see some old <a class="text-gray-600 hover:text-sky-600" href="/code/">code</a>)</p> </div> </footer> </body></html>