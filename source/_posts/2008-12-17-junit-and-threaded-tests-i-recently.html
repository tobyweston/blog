--- 
name: junit-and-threaded-tests-i-recently
layout: post
title: JUnit and Threaded Tests
time: 2008-12-17 18:52:00 +00:00
---
I recently noticed a bit of a problem when playing with threads within <span class="blsp-spelling-error" id="SPELLING_ERROR_0">JUnit</span>. Take the following snippet as an example;<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://2.bp.blogspot.com/_-uMxV_fCbC4/SUlOlaoBGJI/AAAAAAAAC0E/I1NXP9vyXHw/s1600-h/thread.PNG"><img style="cursor: pointer; width: 400px; height: 234px;" src="http://2.bp.blogspot.com/_-uMxV_fCbC4/SUlOlaoBGJI/AAAAAAAAC0E/I1NXP9vyXHw/s400/thread.PNG" alt="" id="BLOGGER_PHOTO_ID_5280838442777909394" border="0" /></a><br /><br />Here, the string "<span style="font-family:courier new;">bye</span>" is never shown, it would seem that when the test method finishes it somehow messes with the threads...<br /><br />Looking into things, it seems in my case that naughty Eclipse is muddying the water! The <span style="font-size:85%;"><span style="font-family:courier new;"><span class="blsp-spelling-error" id="SPELLING_ERROR_1">RemoteTestRunner</span></span></span> class which Eclipse uses to run the tests ends up calling <span style=";font-family:courier new;font-size:85%;"  >System.exit(0)</span> after it's run all the tests to kill the parent Java process. Even if we changed the daemon status of the thread, you'd get the same behaviour, <span class="blsp-spelling-error" id="SPELLING_ERROR_2">ie</span>, no "bye" being shown. Bad robot.<br /><br />So, in some situations it is possible to <span class="blsp-spelling-corrected" id="SPELLING_ERROR_3">interrupt</span> a thread in a <span class="blsp-spelling-error" id="SPELLING_ERROR_4">JUnit</span> test bypassing the <span class="blsp-spelling-corrected" id="SPELLING_ERROR_5">interrupt</span> mechanism when running a test from Eclipse. <span class="blsp-spelling-error" id="SPELLING_ERROR_6">IntelliJ</span> actually seems to have the same behaviour but I can't review to source to confirm.<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://lh6.ggpht.com/_-uMxV_fCbC4/SVInGoVdYJI/AAAAAAAAC08/I4RV1KzCyPo/gibble_22x22.png"><img style="margin: 0pt 10px 10px 0pt; float: left; cursor: pointer; width: 22px; height: 22px;" src="http://lh6.ggpht.com/_-uMxV_fCbC4/SVInGoVdYJI/AAAAAAAAC08/I4RV1KzCyPo/gibble_22x22.png" alt="" border="0" /></a><div class="blogger-post-footer"><img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/20485368-5329960031028190216?l=pequenoperro.blogspot.com' alt='' /></div>
