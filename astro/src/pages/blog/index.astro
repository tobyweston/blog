---
import {getCollection} from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import SiteLayout from '../../components/ui/SiteLayout.astro';
import PostCard from '../../components/ui/PostCard.astro';

const posts = (await getCollection('blog')) as CollectionEntry<'blog'>[];
posts.sort((a: CollectionEntry<'blog'>, b: CollectionEntry<'blog'>) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
const perPage = 12;
const pagePosts = posts.slice(0, perPage);
---

<SiteLayout title="Blog - bad.robot" description="Recent blog posts">
  <section>
    <h1 class="text-3xl font-bold mb-6">Blog</h1>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      {pagePosts.map((p: CollectionEntry<'blog'>) => (
        <PostCard post={p} />
      ))}
    </div>

    {posts.length > perPage && (
      <div class="mt-8 text-center">
        <a href="/blog/page/2" class="px-4 py-2 border rounded">Older posts</a>
      </div>
    )}
  </section>
</SiteLayout>
